function startGame(){var e=document.getElementById("game"),n=document.getElementById("house"),t=document.getElementById("score"),o=document.getElementById("divider"),a=document.getElementById("bell"),l=getComputedStyle(document.body).fontSize,i=l.substring(0,l.length-2),s=generateSnowflakes(e),d=santaAnimations(e,n,i,t,o),c=houseAnimations(e,n,i,t,o);a.className.indexOf("bell-off")===-1&&sound.unmute(),setTimeout(function(){window.scrollTo(0,document.body.scrollHeight),document.addEventListener("touchmove",function(e){e.preventDefault()})},100),startTimer(15,function(){s(),d(),c(),sound.bells(),sound.merryXmas(),sound.mute();var e=t.innerHTML;document.querySelector('meta[property="og:description"]').content="My score is "+e+"! Try to beat me and read some holiday wishes.",document.getElementById("backdrop").className+=" backdrop-visible",document.getElementById("endModal").className+=" modal-visible",document.getElementById("endModalScore").innerHTML=e,t.innerHTML="0"})}function toMailModal(){var e=document.getElementById("endModal"),n=document.getElementById("sendToFriendModal");e.className=e.className.replace(" modal-visible",""),n.className=n.className+" modal-visible"}function toEndModal(){var e=document.getElementById("endModal"),n=document.getElementById("sendToFriendModal");n.className=e.className.replace(" modal-visible",""),e.className=n.className+" modal-visible"}function clearMailForm(){document.getElementById("sendToEmail").value="",document.getElementById("messageBody").value=""}function checkAvailableAPIs(){if(Modernizr.eventlistener&&Modernizr.opacity&&Modernizr.cssanimations&&Modernizr.csstransforms&&Modernizr.csstransitions)console.log("All good to go");else{console.log("Some feature is missing");for(var e in Modernizr)console.log("Feature "+e+" "+Modernizr[e]);document.getElementById("notSupported").style.display="block"}}function houseAnimations(e,n,t,o,a){function l(e){e+c>u?n.style.left=u-d+"px":e-c<m?n.style.left=m+"px":n.style.left=e-c+"px"}function i(e){l(e.clientX)}function s(e){0!==e.targetTouches.length&&l(e.targetTouches.item(0).clientX)}var d=n.getBoundingClientRect().right-n.getBoundingClientRect().left,c=d/2,r=1.5*t,m=a.getBoundingClientRect().left-r,u=a.getBoundingClientRect().right+r;return document.addEventListener("mousemove",i),e.addEventListener("touchmove",s),function(){document.removeEventListener("mousemove",i),n.removeEventListener("touchmove",s)}}function santaAnimations(e,n,t,o){function a(e){var n=d.getBoundingClientRect().left,t=d.getBoundingClientRect().right,o=e.getBoundingClientRect().left,a=e.getBoundingClientRect().right;e.style.left=n+(t-n)-(a-o)+"px"}function l(){var n=document.createElement("span");n.className="gift",n.style.animationDuration=i(u,g)/1e3+"s",n.addEventListener("animationend",s,!1),e.appendChild(n),a(n)}function i(e,n){return Math.round(Math.random()*(n-e))+e}function s(a){var l=Number(n.style.left.substring(0,n.style.left.length-2)),i=Number(this.style.left.substring(0,this.style.left.length-2))-6.5*t,d=Number(this.style.animationDuration.substring(0,this.style.animationDuration.length-1));if(Math.abs(l-i)<f){var c=Number(o.innerHTML);sound.giftCatch(),window.hackerPresent?o.innerHTML=c+2:o.innerHTML=c+1,e.removeChild(this)}else this.className+=" gift-to-ground",this.style.animationDuration=Math.round(d*m*100)/100+"s",this.removeEventListener("animationend",s),this.addEventListener("animationend",function(){e.removeChild(this)})}var d=document.getElementById("santa"),c=!1,r=!1,m=.5,u=800,g=2500,f=5*t;return window.matchMedia("(max-device-width: 768px)").matches&&(console.log("We are on mobile"),m=.2,u=1200,g=3500,f=6*t),function e(){var n=i(400,1800);setTimeout(function(){l(),c===!1&&e()},n)}(),function e(){var n=i(6e3,12e3);setTimeout(function(){sound.hoHoHo(),r===!1&&e()},n)}(),function(){c=!0,r=!0}}function generateSnowflakes(e){function n(n){var t=e.getBoundingClientRect().left,o=e.getBoundingClientRect().right;n.style.left=Math.random()*(o-t)+t+"px"}function t(e){var n=100*Math.random();n<40?e.className="snowflake snowflake-small":n>=40<70?e.className="snowflake snowflake-normal":e.className="snowflake snowflake-big"}var o=setInterval(function(){var e=document.createElement("span");n(e),t(e),e.addEventListener("animationend",function(){document.body.removeChild(this)}),document.body.appendChild(e)},1500);return function(){clearInterval(o)}}function startTimer(e,n){var t=document.getElementById("time"),o=e;t.innerHTML=e;var a=setInterval(function(){o--,o>=0?t.innerHTML=o:(clearInterval(a),n())},1e3)}window.onload=function(){checkAvailableAPIs();var e=document.getElementById("backdrop"),n=document.getElementById("startModal");document.getElementById("hwLogo");sound.bells(),sound.hoHoHo(),setTimeout(function(){var t=document.getElementById("santaIntro");e.className=e.className.replace(" backdrop-white",""),t.className=t.className+" fly-away",n.className=n.className.replace(" modal-invisible","")},1500);var t=document.getElementById("restartGameBtn");t.addEventListener("click",function(){var n=document.getElementById("endModal");e.className=e.className.replace(" backdrop-visible",""),n.className=n.className.replace(" modal-visible",""),startGame()});var o=document.getElementById("startGameBtn");o.addEventListener("click",function(){e.className=e.className.replace(" backdrop-visible",""),n.className=n.className.replace(" modal-visible",""),startGame()});var a=document.getElementById("sendToFriendBtn");a.addEventListener("click",function(){toMailModal()});var l=document.getElementById("cancelMail");l.addEventListener("click",function(){toEndModal(),clearMailForm()});var i=document.getElementById("sendMail");i.addEventListener("click",function(){var e=document.getElementById("sendToEmail").value,n=document.getElementById("messageBody").value,t=encodeURI("Happy Holidays!");n+="\n--\nIt's the holly-jolly holiday season. Hope you relax and enjoy the time with family and loved ones. Join us for some fun at Honeywell as well at https://honeywell-pf2017.github.io\n\n",window.open("mailto:"+e+"?subject="+t+"&body="+encodeURI(n),"_self"),toEndModal(),clearMailForm(),FB.AppEvents.logEvent("openedMailToFriend")});var s=document.getElementById("bell");s.addEventListener("click",function(){sound.muted()?(s.className=s.className.replace(" bell-off",""),sound.unmute()):(s.className=s.className+" bell-off",sound.mute())});var d=document.getElementById("shareToFacebook");d.addEventListener("click",function(){var e="https://honeywell-pf2017.github.io";return window.open("https://www.facebook.com/sharer/sharer.php?u="+e,"facebook-share-dialog","width=626,height=436"),FB.AppEvents.logEvent("openedShareToFacebook"),!1});var c=document.getElementById("corner"),r=0;c.addEventListener("click",function(){r++,5===r&&(window.hackerPresent=!0,console.log("Hacker detected"),document.getElementById("santa").style.backgroundImage="url('svg/hackerSanta.svg')",FB.AppEvents.logEvent("hackerDetected"))})};var sound=function(){function e(e,n){if(!r){var t=document.createElement("audio");return t.src=e,t.loop=!!n,t.volume=.2,t.addEventListener("ended",function(){document.body.removeChild(this)}),document.body.appendChild(t),t.play(),t}}function n(){r=!0,c&&c.pause()}function t(){r=!1,c?c.play():d()}function o(){return r}function a(){e("sounds/gift"+m+".mp3"),m++,m>4&&(m=1)}function l(){e("sounds/hoho.mp3")}function i(){e("sounds/xmas.mp3")}function s(){e("sounds/bell.mp3")}function d(){var n=!1;c&&document.body.removeChild(c),c=e("sounds/back.mp3",n)}var c,r=!1,m=1;return{giftCatch:a,hoHoHo:l,merryXmas:i,bells:s,background:d,mute:n,unmute:t,muted:o}}();