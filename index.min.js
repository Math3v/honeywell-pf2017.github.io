function startGame(){var e=document.getElementById("game"),n=document.getElementById("house"),t=document.getElementById("score"),o=document.getElementById("divider"),a=document.getElementById("bell"),l=getComputedStyle(document.body).fontSize,s=l.substring(0,l.length-2),i=generateSnowflakes(e),d=santaAnimations(e,n,s,t,o),c=houseAnimations(e,n,s,t,o);a.className.indexOf("bell-off")===-1&&sound.unmute(),sound.background(),setTimeout(function(){window.scrollTo(0,document.body.scrollHeight),document.addEventListener("touchmove",function(e){e.preventDefault()})},100),startTimer(30,function(){i(),d(),c(),sound.bells(),sound.merryXmas(),sound.mute();var e=t.innerHTML;document.querySelector('meta[property="og:description"]').content="My score is "+e+"! Try to beat me and read some holiday wishes.",document.getElementById("backdrop").className+=" backdrop-visible",document.getElementById("endModal").className+=" modal-visible",document.getElementById("endModalScore").innerHTML=e,t.innerHTML="0"})}function toMailModal(){var e=document.getElementById("endModal"),n=document.getElementById("sendToFriendModal");e.className=e.className.replace(" modal-visible",""),n.className=n.className+" modal-visible"}function toEndModal(){var e=document.getElementById("endModal"),n=document.getElementById("sendToFriendModal");n.className=e.className.replace(" modal-visible",""),e.className=n.className+" modal-visible"}function clearMailForm(){document.getElementById("sendToEmail").value="",document.getElementById("messageBody").value=""}function houseAnimations(e,n,t,o,a){function l(e){e+c>u?n.style.left=u-d+"px":e-c<r?n.style.left=r+"px":n.style.left=e-c+"px"}function s(e){l(e.clientX)}function i(e){0!==e.targetTouches.length&&l(e.targetTouches.item(0).clientX)}var d=n.getBoundingClientRect().right-n.getBoundingClientRect().left,c=d/2,m=1.5*t,r=a.getBoundingClientRect().left-m,u=a.getBoundingClientRect().right+m;return document.addEventListener("mousemove",s),e.addEventListener("touchmove",i),function(){document.removeEventListener("mousemove",s),n.removeEventListener("touchmove",i)}}function santaAnimations(e,n,t,o){function a(e){var n=d.getBoundingClientRect().left,t=d.getBoundingClientRect().right,o=e.getBoundingClientRect().left,a=e.getBoundingClientRect().right;e.style.left=n+(t-n)-(a-o)+"px"}function l(){var n=document.createElement("span");n.className="gift",n.style.animationDuration=s(1500,6e3)/1e3+"s",n.addEventListener("animationend",i,!1),e.appendChild(n),a(n)}function s(e,n){return Math.round(Math.random()*(n-e))+e}function i(a){var l=Number(n.style.left.substring(0,n.style.left.length-2)),s=Number(this.style.left.substring(0,this.style.left.length-2))-6.5*t,d=Number(this.style.animationDuration.substring(0,this.style.animationDuration.length-1));if(Math.abs(l-s)<5*t){var c=Number(o.innerHTML);sound.giftCatch(),window.hackerPresent?o.innerHTML=c+2:o.innerHTML=c+1,e.removeChild(this)}else this.className+=" gift-to-ground",this.style.animationDuration=.45*d+"s",this.removeEventListener("animationend",i),this.addEventListener("animationend",function(){e.removeChild(this)})}var d=document.getElementById("santa"),c=!1,m=!1;return function e(){var n=s(400,1800);setTimeout(function(){l(),c===!1&&e()},n)}(),function e(){var n=s(6e3,12e3);setTimeout(function(){sound.hoHoHo(),m===!1&&e()},n)}(),function(){c=!0,m=!0}}function generateSnowflakes(e){function n(n){var t=e.getBoundingClientRect().left,o=e.getBoundingClientRect().right;n.style.left=Math.random()*(o-t)+t+"px"}function t(e){var n=100*Math.random();n<40?e.className="snowflake snowflake-small":n>=40<70?e.className="snowflake snowflake-normal":e.className="snowflake snowflake-big"}var o=setInterval(function(){var e=document.createElement("span");n(e),t(e),e.addEventListener("animationend",function(){document.body.removeChild(this)}),document.body.appendChild(e)},1500);return function(){clearInterval(o)}}function startTimer(e,n){var t=document.getElementById("time"),o=e;t.innerHTML=e;var a=setInterval(function(){o--,o>=0?t.innerHTML=o:(clearInterval(a),n())},1e3)}window.onload=function(){var e=document.getElementById("backdrop"),n=document.getElementById("startModal");sound.bells(),sound.hoHoHo(),setTimeout(function(){var t=document.getElementById("hwLogo");e.className=e.className.replace(" backdrop-white",""),t.className=t.className+" fly-away",n.className=n.className.replace(" modal-invisible","")},1500);var t=document.getElementById("restartGameBtn");t.addEventListener("click",function(){var n=document.getElementById("endModal");e.className=e.className.replace(" backdrop-visible",""),n.className=n.className.replace(" modal-visible",""),startGame()});var o=document.getElementById("startGameBtn");o.addEventListener("click",function(){e.className=e.className.replace(" backdrop-visible",""),n.className=n.className.replace(" modal-visible",""),startGame()});var a=document.getElementById("sendToFriendBtn");a.addEventListener("click",function(){toMailModal()});var l=document.getElementById("cancelMail");l.addEventListener("click",function(){toEndModal(),clearMailForm()});var s=document.getElementById("sendMail");s.addEventListener("click",function(){var e=document.getElementById("sendToEmail").value,n=document.getElementById("messageBody").value,t=encodeURI("Merry Christmas full of fun!");n+="\n--\nSent from: https://honeywell-pf2017.github.io\n",console.log(t,e,encodeURI(n)),window.open("mailto:"+e+"?subject="+t+"&body="+encodeURI(n),"_self"),toEndModal(),clearMailForm()});var i=document.getElementById("bell");i.addEventListener("click",function(){sound.muted()?(i.className=i.className.replace(" bell-off",""),sound.unmute()):(i.className=i.className+" bell-off",sound.mute())});var d=document.getElementById("corner"),c=0;d.addEventListener("click",function(){c++,5===c&&(window.hackerPresent=!0,console.log("Hacker detected"),document.getElementById("santa").style.backgroundImage="url('svg/hackerSanta.svg')")})};var sound=function(){function e(e,n){if(!m){var t=document.createElement("audio");return t.src=e,t.loop=!!n,t.addEventListener("ended",function(){document.body.removeChild(this)}),document.body.appendChild(t),t.play(),t}}function n(){m=!0,c&&c.pause()}function t(){m=!1,c?c.play():d()}function o(){return m}function a(){e("sounds/gift"+r+".mp3"),r++,r>4&&(r=1)}function l(){e("sounds/hoho.mp3")}function s(){e("sounds/xmas.mp3")}function i(){e("sounds/bell.mp3")}function d(){var n=!1;c&&document.body.removeChild(c),c=e("sounds/back.mp3",n)}var c,m=!1,r=1;return{giftCatch:a,hoHoHo:l,merryXmas:s,bells:i,background:d,mute:n,unmute:t,muted:o}}();